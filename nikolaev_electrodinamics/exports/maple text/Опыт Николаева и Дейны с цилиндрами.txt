# Опыт Николаева и Дейны с цилиндрами
# 
# Рассмотрим опыт Николаева и Дейны с взаимодействием двух соосно расположенных цилиндров со сверлением, намагничиваемых путём пропускания тока по проводу проходящему внутри сверлений. 
# 
# Согласно курсу теории электричества Тамма, раздел Магнетики, параграф 60, п.3, "для построения теории магнетиков ... среднее по физически бесконечно малому объёму значение плотности молекулярных токов j__mol. Среднее значение тока взятое по всему объёму замкнутых токов равно нулю."
# 
# Но для тороидального намагниченного цилиндра ввиду того что кольцевые молекулярные токи в проекции образуют "ёлочку" при выделении физичеки бесконечно малого объёма можно видеть, что среднее значение молекулярных токов не равно нулю.
# 
# Примем, что ввиду однородной намагниченности поверхностная составляющая среднего значения молекулярных токов на поверхности циркулярно намагниченного цилиндра с соосным сверлением постоянна и имеет значение j__surf . Интегрируя поверхностный ток по внешней поверхности цилиндра получим 2*Pi*R__внешн*dz*j__surf; Интегрируя поверхностный ток по внутренней поверхности сверлений получим 2*Pi*R__внутр*dz*j__surf;  Интегральное значение среднего молекулярного поверхностного тока на внешней поверхности цилидра больше интегрального значения среднего молекулярного поверхностного тока на поверхности внутреннего сверления в 2*Pi*R__внешн*dz*j__surf/(2*Pi*R__внутр*dz*j__surf) = R__внешн/R__внутр; раз.
# Расмотрим поверхностный ток на торцевой поверхности цилиндра. Интегральное значение поверхностного тока в пределах воображаемого на торцевой поверхности кольцевой полоски ограниченной окружностями радиусов R-dR/2 и R+dR/2 равное 2*Pi*R*j__surf; не постоянно, а пропорционально радиусу R. Если взять на одной и той же торцевой поверхности две соседние кольцевые полоски ограниченные окружностями радиусов 1)  R-dR и R, 2) R и R+dR то интегральный ток в них будет равен соответственно 2*Pi*(R-(1/2)*dR)*j__surf;  и 2*Pi*(R+(1/2)*dR)*j__surf; Разница составит 2*Pi*dR*j__surf; И эта разница должна замыкаться объёмным током. Таким образом в цилиндрическом слоё объёма намагниченного цилиндра заключённом между воображаемыми цилиндрическими поверхностями радиусов R-dR/2 и R+dR/2 заключён интегральный средний по объёму молекулярных токов ток равный 2*Pi*dR*j__surf;  Для получения плотности среднего по объёму молекулярного тока разделим на объём заключённый между воображаемыми цилиндрическими поверхностями. Таким образом получим j__v = 2*Pi*dR*j__surf/(2*Pi*R*dR) and 2*Pi*dR*j__surf/(2*Pi*R*dR) = j__surf/R;
# 
# На границе намагниченных магнетиков вектор плотности поверхностных токов пропорционален векторному произведения вектора нормали на вектор намагничивания  j__surf = c*[n*I];
# Вектор намагничивания I определяется как магнитный момент молекулярных токов рассчитанный на единицу объёма   I = (int([`&x`(R, j__mol)], V))/(2*c*`&Delta;V`);
# Если цилиндр имеет равномерную циркулярную намагниченность, то плотность поверхностных токов всюду одинакова.
# 
# Рассчитаем теперь согласно классической электродинамике силу взаимодействия между цилиндрами в опыте Дейны как градиент потенциальной функции взаимодействия токов согласно Тамм, параграф 51 "Пондемоторное взаимодействие токов"
# 
# Примем следующие обозначения: z1__max - координата правого края левого цилиндра z2__min - координата левого края правого цилиндра, dz длина цилиндров по оси z (высота цилинров), r__min - радиус внутреннего сверления в цилиндрах, r__max - радиус внешей поверхности цилиндров
# 
> clear;
> assume(r__min, 'real', r__min > 0, r__max, 'real', r__max > r_min, z1__max, 'real', z1__max < 0, dz, 'real', dz > 0, z2__min, 'real', z2__min > 0);
# 
# Потенциальная функция взаимодействия объёмных токов
> Uvv := -1/(c^2)*Int(j__surf__1*j__surf__2 /
> sqrt((r__1*cos(varphi__1)-r__2*cos(varphi__2))^2+(r__1*sin(varphi__1)-r__2*sin(varphi__2))^2+(z__1-z__2)^2),
> [z__1 = z1__max-dz .. z1__max, varphi__1 = 0 .. 2*Pi, r__1=r__min..r__max, 
>  z__2 = z2__min .. z2__min + dz, varphi__2 = 0 .. 2*Pi, r__2=r__min..r__max]):
# 
# Потенциальная функция взаимодействия поверхностных токов на поверхностях цилиндров
> Uss := -1/(c^2)*Int(j__surf__1*j__surf__2 * R__1 * R__2 /
> sqrt((R__1*cos(varphi__1)-R__2*cos(varphi__2))^2+(R__1*sin(varphi__1)-R__2*sin(varphi__2))^2+(z__1-z__2)^2), 
> [z__1 = z1__max-dz .. z1__max, varphi__1 = 0 .. 2*Pi, 
>  z__2 = z2__min .. z2__min + dz, varphi__2 = 0 .. 2*Pi]):
# 
# Суммарная потенциальная функция взаимодействия поверхностных токов на обоих поверхностях (внутренней и внешней) обоих цилиндров
> 
> Uss4 := 
>  + subs(R__1=r__max, R__2=r__max, Uss)
>  + subs(R__1=r__min, R__2=r__min, Uss)
>  - subs(R__1=r__max, R__2=r__min, Uss)
>  - subs(R__1=r__min, R__2=r__max, Uss):# 
;
# 
# Потенциальная функция взаимодействия поверхностных токов на торцах цилиндров
# 
> Utt := -1/(c^2)*Int(j__surf__1*j__surf__2*r__1*r__2*cos(varphi__1-varphi__2) /
> sqrt(r__1^2 + r__2^2 - 2 * r__1 * r__2 * (cos(varphi__1) * cos(varphi__2) + sin(varphi__1)*sin(varphi__2)) + (z__1 - z__2)^2),
> [varphi__1 = 0 .. 2*Pi,   varphi__2 = 0 .. 2*Pi, 
>  r__1 = r__min .. r__max, r__2 = r__min .. r__max]):
> 
;
# Суммарная потенциальная функция взаимодействия поверхностных токов на обоих торцах обоих цилиндров
> Utt4 := 
>  - subs(z__1=z1__max,    z__2=z2__min, Utt)
>  + subs(z__1=z1__max-dz, z__2=z2__min, Utt)
>  + subs(z__1=z1__max,    z__2=z2__min+dz, Utt)
>  - subs(z__1=z1__max-dz, z__2=z2__min+dz, Utt):# 
;
# 
# Потенциальная функция взаимодействия объёмных токов с поверхностными
# Взаимодействие поверхностного тока левого цилиндра с объёмным током правого
> Usv := -1/(c^2) * Int(j__surf__1*j__surf__2 * R__s1 / 
> sqrt((R__s1*cos(varphi__s)-r__v*cos(varphi__v))^2+(R__s1*sin(varphi__s)-r__v*sin(varphi__v))^2+(z__s-z__v)^2), 
> [z__s = z1__max-dz .. z1__max, varphi__s = 0 .. 2*Pi, 
>  z__v = z2__min .. z2__min+dz, varphi__v = 0 .. 2*Pi, r__v = r__min .. r__max]):# 
;
# 
# Взаимодействие поверхностного тока правого цилиндра с объёмным током левого
> Uvs := -1/(c^2) * Int(j__surf__1*j__surf__2 * R__s2 /
> sqrt((R__s2*cos(varphi__s)-r__v*cos(varphi__v))^2+(R__s2*sin(varphi__s)-r__v*sin(varphi__v))^2+(z__s-z__v)^2),
> [z__s = z2__min .. z2__min+dz, varphi__s = 0 .. 2*Pi,
>  z__v = z1__max-dz .. z1__max, varphi__v = 0 .. 2*Pi, r__v = r__min .. r__max]):# 
;
# 
# Суммарная потенциальная функция взаимодействия объёмных токов с поверхностными
> Uvs4 := 
>  - subs(R__s1=r__max, Usv)
>  + subs(R__s1=r__min, Usv)
>  + subs(R__s2=r__min, Uvs)
>  - subs(R__s2=r__max, Uvs) :# 
;
# 
# Полная потенциальная функция взаимодействия
> U := Uvv+Uss4+Utt4+Uvs4;
# 
# Сила действующая на цилиндры. С индексом 1 сила действующая на левый цилиндр, с индексом 2 сила действующая на правый
# 
# Полная сила
> F__1 := -(diff(U, z1__max));# 
;
> F__2 := -(diff(U, z2__min));
# 
# Сила взаимодействия объёмных токов
> Fvv__1 := -(diff(Uvv, z1__max));
> Fvv__2 := -(diff(Uvv, z2__min));
# 
# Сила  взаимодействия поверхностных токов
> Fss4__1 := -(diff(Uss4, z1__max));
> Fss4__2 := -(diff(Uss4, z2__min));
# 
# Сила взаимодействия торцевых токов
> Ftt4__1 := -(diff(Utt4, z1__max));
> Ftt4__2 := -(diff(Utt4, z2__min));
# 
# Сила взаимодействия поверхностных токов с объёмными
> Fvs4__1 := -(diff(Uvs4, z1__max));
> Fvs4__2 := -(diff(Uvs4, z2__min));
# 
> Digits := 3;
# 
> R__min := .2; R__max := 1; Z2__min := 0.2e-1; Z1__max := -0.2e-1; DZ := 1;
# 
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fvv__1));
                              14.4
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fvv__2));
                             -14.4
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fss4__1));
                              13.4
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fss4__2));
                             -13.4
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Ftt4__1));
                             -13.7
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Ftt4__2));
                              13.7
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fvs4__1));# 
                             -14.0
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fvs4__2));
                              14.0
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fss4__1+Ftt4__1));# 
                             -0.292
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fss4__2+Ftt4__2));
                             0.292
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, F__1));# 
                              0.1
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, F__2));
                              -0.1
;
# Итак мы видим, что расчёт основанный на представлениях классической электродинамики для опыта Дейны с цилиндрами предсказывает притягивание цилиндров, что собственно и наблюдается на опыте. 
# 
# Однако согласно утверждениям Николаева цилиндры по классике должны отталкиваться. Действительно, если учитывать только лишь взаимодействие поверхностных токов по вышеприведенным формулам, то можно получить противоречащий опыту результат (отталкивание цилиндров). Но этот результат ошибочен так как он не учитывает взаимодействие объёмных токов цилиндров между собой и взаимодействие объёмых токов с поверхностными.
# 
# Можно рассмотреть случай взаимодействия только лишь поверхностных токов на примере модели тороидальных катушек с током, намотанных на цилиндр с соосным сверлением. Однако в этом случае нужно для плотности поверхностных токов применять другие формулы, отличающиеся тем, что поверхностная плотность токов не будет постоянной по всей поверхности цилиндров.
# 
# Потенциальная функция взаимодействия токов проволочной обмотки на поверхностях цилиндров
> Uwss := -1/(c^2)*Int(j__surf__1*j__surf__2 * r__min * r__min /
> sqrt((R__1*cos(varphi__1)-R__2*cos(varphi__2))^2+(R__1*sin(varphi__1)-R__2*sin(varphi__2))^2+(z__1-z__2)^2), 
> [z__1 = z1__max-dz .. z1__max, varphi__1 = 0 .. 2*Pi, 
>  z__2 = z2__min .. z2__min + dz, varphi__2 = 0 .. 2*Pi]):
# 
# Суммарная потенциальная функция взаимодействия токов проволочной обмотки на обоих поверхностях (внутренней и внешней) обоих цилиндров
> 
> Uwss4 := 
>  + subs(R__1=r__max, R__2=r__max, Uwss)
>  + subs(R__1=r__min, R__2=r__min, Uwss)
>  - subs(R__1=r__max, R__2=r__min, Uwss)
>  - subs(R__1=r__min, R__2=r__max, Uwss):# 
;
# 
# Потенциальная функция взаимодействия токов проволочной обмотки на торцах цилиндров
> Uwtt := -1/(c^2)*Int(j__surf__1*j__surf__2*r__min*r__min*cos(varphi__1-varphi__2) /
> sqrt(r__1^2 + r__2^2 - 2 * r__1 * r__2 * (cos(varphi__1) * cos(varphi__2) + sin(varphi__1)*sin(varphi__2)) + (z__1 - z__2)^2),
> [varphi__1 = 0 .. 2*Pi,   varphi__2 = 0 .. 2*Pi, 
>  r__1 = r__min .. r__max, r__2 = r__min .. r__max]):# 
;
> 
;
# Суммарная потенциальная функция взаимодействия токов проволочной обмотки на обоих торцах обоих цилиндров
> Uwtt4 := 
>  - subs(z__1=z1__max,    z__2=z2__min, Uwtt)
>  + subs(z__1=z1__max-dz, z__2=z2__min, Uwtt)
>  + subs(z__1=z1__max,    z__2=z2__min+dz, Uwtt)
>  - subs(z__1=z1__max-dz, z__2=z2__min+dz, Uwtt):# 
;
# 
# Полная потенциальная функция взаимодействия токов проволочной обмотки
> Uw := Uwss4+Uwtt4;
# 
# Сила действующая на цилиндры. С индексом 1 сила действующая на левый цилиндр, с индексом 2 сила действующая на правый
# 
# Полная сила
> Fw__1 := -(diff(Uw, z1__max));# 
;
> Fw__2 := -(diff(Uw, z2__min));
# 
# Сила  взаимодействия поверхностных токов проволочной обмотки
> Fwss4__1 := -(diff(Uwss4, z1__max));
> Fwss4__2 := -(diff(Uwss4, z2__min));
# 
# Сила взаимодействия торцевых токов проволочной обмотки
> Fwtt4__1 := -(diff(Uwtt4, z1__max));
> Fwtt4__2 := -(diff(Uwtt4, z2__min));
# 
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fwss4__1));
                              1.84
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fwss4__2));
                             -1.84
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fwtt4__1));
                             -1.84
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fwtt4__2));
                              1.84
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fw__1));# 
                             0.0008
;
> evalf(subs(r__min = R__min, r__max = R__max, z2__min = Z2__min, z1__max = Z1__max, dz = DZ, j__surf__1 = 1, j__surf__2 = 1, c = 1, Fw__2));
                            -0.0008
;
> 
;
